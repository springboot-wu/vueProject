{"remainingRequest":"E:\\vue_lianxi\\lianxi\\lianxi\\node_modules\\babel-loader\\lib\\index.js!E:\\vue_lianxi\\lianxi\\lianxi\\node_modules\\cache-loader\\dist\\cjs.js??ref--0-0!E:\\vue_lianxi\\lianxi\\lianxi\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!E:\\vue_lianxi\\lianxi\\lianxi\\src\\views\\layout.vue?vue&type=script&lang=js&","dependencies":[{"path":"E:\\vue_lianxi\\lianxi\\lianxi\\src\\views\\layout.vue","mtime":1575426627155},{"path":"E:\\vue_lianxi\\lianxi\\lianxi\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"E:\\vue_lianxi\\lianxi\\lianxi\\node_modules\\babel-loader\\lib\\index.js","mtime":499162500000},{"path":"E:\\vue_lianxi\\lianxi\\lianxi\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"E:\\vue_lianxi\\lianxi\\lianxi\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":["import \"regenerator-runtime/runtime\";\nimport _asyncToGenerator from \"E:\\\\vue_lianxi\\\\lianxi\\\\lianxi\\\\node_modules\\\\@babel\\\\runtime-corejs2/helpers/esm/asyncToGenerator\";\nimport \"core-js/modules/es6.function.name\";\nimport \"core-js/modules/es6.regexp.replace\";\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nimport Users from \"./list.vue\";\nimport qs from 'qs'; //const delUsers=[];\n\nexport default {\n  name: 'users',\n  components: {\n    Users: Users\n  },\n  data: function data() {\n    // 自定义一个手机号验证规则\n    var checkMoblie = function checkMoblie(rule, value, callback) {\n      if (!value.trim()) {\n        return callback(new Error('请输入手机号'));\n      }\n\n      if (!/^1[34578]\\d{9}$/.test(value)) {\n        return callback(new Error('手机号有误！请重填'));\n      } else {\n        callback();\n      }\n    };\n\n    return {\n      isRouterAlive: true,\n      dialogTableVisible: false,\n      // 添加用户弹框\n      dialogmallVisible: false,\n      data: [],\n      delUsers: [],\n      tilevar: [],\n      options: [],\n      defaultProps: {\n        children: 'popedomChildList',\n        label: 'mname'\n      },\n      // 添加用户\n      addUser: {\n        id: '',\n        name: '',\n        mid: '',\n        sex: '',\n        tellphone: '',\n        deptid: ''\n      },\n      addmall: {\n        pid: '',\n        mname: ''\n      },\n      rulesAddUser: {\n        name: [{\n          required: true,\n          message: '请输入用户名',\n          trigger: 'blur'\n        }],\n        sex: [{\n          required: true,\n          message: '请输入性别',\n          trigger: 'blur'\n        }],\n        tellphone: [{\n          required: true,\n          message: '请输入手机号',\n          trigger: 'blur'\n        }, {\n          validator: checkMoblie,\n          trigger: 'blur'\n        }]\n      }\n    };\n  },\n  mounted: function mounted() {\n    //钩子函数\n    this.get();\n    this.depts();\n    this.inituserlist();\n  },\n  methods: {\n    addDialogClose: function addDialogClose() {\n      this.addUser = {\n        id: '',\n        name: '',\n        mid: '',\n        sex: '',\n        tellphone: '',\n        deptid: '' //  this.$refs.addFormRef.resetFields() //  不好使待检查\n\n      };\n    },\n    get: function get() {\n      this.$http.get('http://localhost:8081/queryMaillist', {}).then(function (res) {\n        console.log(\"=================allllll\");\n        console.log(res.data);\n        this.data = res.data;\n      });\n    },\n    inituserlist: function inituserlist() {\n      this.$http.get('http://localhost:8081/userListBymid', {\n        params: {\n          id: 1\n        }\n      }).then(function (res) {\n        //alert(title)\n        console.log(res);\n        this.tilevar = res.data;\n        console.log(this.userList);\n      });\n    },\n    depts: function depts() {\n      this.$http.get('http://localhost:8081/deptlist', {}).then(function (res) {\n        console.log(\"=================depts\");\n        console.log(res.data); // this.data = res.data;\n\n        this.options = res.data;\n      });\n    },\n    handleOpen: function handleOpen(key, keyPath) {\n      console.log(key, keyPath);\n    },\n    handleClose: function handleClose(key, keyPath) {\n      console.log(key, keyPath);\n    },\n    goTo: function goTo(path) {\n      this.$router.replace(path);\n    },\n    handleNodeClick: function handleNodeClick(data) {\n      //  添加通讯录赋值\n      this.addmall.fname = data.mname;\n      this.addmall.pid = data.mid; //添加用户赋值\n\n      this.addUser.mname = data.mname;\n      this.addUser.mid = data.mid;\n      console.log(data);\n      this.$http.get('http://localhost:8081/userListBymid', {\n        params: {\n          id: data.mid\n        }\n      }).then(function (res) {\n        console.log(\"==========\");\n        console.log(res.data);\n        console.log(\"==============\");\n        this.tilevar = res.data;\n        console.log(this.userList);\n      });\n    },\n    deleteUsers: function deleteUsers(data) {\n      var _this = this;\n\n      var userDto = this.delUsers; //  执行删除的方法\n\n      this.$confirm('确认删除？').then(function (_) {\n        _this.$http.post('http://localhost:8081/deleUserBatch', userDto).then(function (res) {\n          console.log(res);\n          this.reload(); //刷新页面\n\n          location.reload();\n        });\n      });\n    },\n    getVal: function getVal(result) {\n      console.log(result + \"=====\");\n      this.delUsers = result;\n    },\n    getBj: function getBj(result) {\n      console.log(result + \"==bj===\");\n      this.dialogTableVisible = true;\n      console.log(result);\n      this.addUser.id = result.id;\n      this.addUser.name = result.name;\n      this.addUser.mname = result.mname;\n      this.addUser.mid = result.mid;\n      this.addUser.sex = result.sex;\n      this.addUser.tellphone = result.tellphone;\n      this.addUser.deptid = result.deptid;\n    },\n    // 点击添加用户\n    onAddUser: function onAddUser() {\n      var _this2 = this;\n\n      //this.$refs.addFormRef.resetFields() // 清空表单\n      this.$refs.addFormRef.validate(\n      /*#__PURE__*/\n      function () {\n        var _ref = _asyncToGenerator(\n        /*#__PURE__*/\n        regeneratorRuntime.mark(function _callee(valid) {\n          var _ref2, res;\n\n          return regeneratorRuntime.wrap(function _callee$(_context) {\n            while (1) {\n              switch (_context.prev = _context.next) {\n                case 0:\n                  debugger;\n\n                  if (valid) {\n                    _context.next = 3;\n                    break;\n                  }\n\n                  return _context.abrupt(\"return\", null);\n\n                case 3:\n                  _context.next = 5;\n                  return _this2.$http.post('http://localhost:8081/addUser', _this2.addUser);\n\n                case 5:\n                  _ref2 = _context.sent;\n                  res = _ref2.data;\n\n                  // this.addUser.name = '';\n                  _this2.$refs.addFormRef.resetFields(); // 清空表单\n                  //刷新页面\n\n\n                  location.reload();\n\n                  if (!(res != true)) {\n                    _context.next = 11;\n                    break;\n                  }\n\n                  return _context.abrupt(\"return\", _this2.$message.error(\"添加失败\"));\n\n                case 11:\n                  _this2.$message.success('添加成功');\n\n                  _this2.dialogTableVisible = false; // 关闭弹框\n\n                  _this2.getUserList(); // 重新调用，刷新表单\n                  //  this.reload();//刷新页面\n                  // location.reload();\n\n\n                case 14:\n                case \"end\":\n                  return _context.stop();\n              }\n            }\n          }, _callee);\n        }));\n\n        return function (_x) {\n          return _ref.apply(this, arguments);\n        };\n      }());\n    },\n    // 添加通讯录\n    onaddmall: function onaddmall() {\n      console.log(\"-------------------------\");\n      console.log(this.addmall);\n      console.log(\"-------------------------\");\n      this.$http.post('http://localhost:8081/addmail', this.addmall).then(function (res) {\n        this.dialogmallVisible = false; //alert(title)\n\n        console.log(res);\n        location.reload();\n      });\n    },\n    reload: function reload() {\n      this.isRouterAlive = false;\n      this.$nextTick(function () {\n        this.isRouterAlive = true;\n      });\n    }\n  }\n};",{"version":3,"sources":["layout.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAiGA,OAAA,KAAA;AACA,OAAA,EAAA,MAAA,IAAA,C,CACA;;AACA,eAAA;AACA,QAAA,OADA;AAEA,cAAA;AACA;AADA,GAFA;AAKA,MALA,kBAKA;AACA;AACA,QAAA,cAAA,SAAA,WAAA,CAAA,IAAA,EAAA,KAAA,EAAA,QAAA,EAAA;AACA,UAAA,CAAA,MAAA,IAAA,EAAA,EAAA;AACA,eAAA,SAAA,IAAA,KAAA,CAAA,QAAA,CAAA,CAAA;AACA;;AACA,UAAA,CAAA,kBAAA,IAAA,CAAA,KAAA,CAAA,EAAA;AACA,eAAA,SAAA,IAAA,KAAA,CAAA,WAAA,CAAA,CAAA;AACA,OAFA,MAEA;AACA;AACA;AACA,KATA;;AAUA,WAAA;AACA,qBAAA,IADA;AAEA,0BAAA,KAFA;AAEA;AACA,yBAAA,KAHA;AAIA,YAAA,EAJA;AAKA,gBAAA,EALA;AAMA,eAAA,EANA;AAOA,eAAA,EAPA;AAQA,oBAAA;AACA,kBAAA,kBADA;AAEA,eAAA;AAFA,OARA;AAYA;AACA,eAAA;AACA,YAAA,EADA;AAEA,cAAA,EAFA;AAGA,aAAA,EAHA;AAIA,aAAA,EAJA;AAKA,mBAAA,EALA;AAMA,gBAAA;AANA,OAbA;AAqBA,eAAA;AACA,aAAA,EADA;AAEA,eAAA;AAFA,OArBA;AAyBA,oBAAA;AACA,cAAA,CACA;AAAA,oBAAA,IAAA;AAAA,mBAAA,QAAA;AAAA,mBAAA;AAAA,SADA,CADA;AAIA,aAAA,CACA;AAAA,oBAAA,IAAA;AAAA,mBAAA,OAAA;AAAA,mBAAA;AAAA,SADA,CAJA;AAOA,mBAAA,CACA;AAAA,oBAAA,IAAA;AAAA,mBAAA,QAAA;AAAA,mBAAA;AAAA,SADA,EAEA;AAAA,qBAAA,WAAA;AAAA,mBAAA;AAAA,SAFA;AAPA;AAzBA,KAAA;AA0CA,GA3DA;AA4DA,WAAA,mBAAA;AAAA;AACA,SAAA,GAAA;AACA,SAAA,KAAA;AACA,SAAA,YAAA;AACA,GAhEA;AAiEA,WAAA;AACA,kBADA,4BACA;AACA,WAAA,OAAA,GAAA;AACA,YAAA,EADA;AAEA,cAAA,EAFA;AAGA,aAAA,EAHA;AAIA,aAAA,EAJA;AAKA,mBAAA,EALA;AAMA,gBAAA,EANA,CAQA;;AARA,OAAA;AASA,KAXA;AAYA,SAAA,eAAA;AACA,WAAA,KAAA,CAAA,GAAA,CAAA,qCAAA,EAAA,EAAA,EACA,IADA,CAEA,UAAA,GAAA,EAAA;AACA,gBAAA,GAAA,CAAA,0BAAA;AACA,gBAAA,GAAA,CAAA,IAAA,IAAA;AACA,aAAA,IAAA,GAAA,IAAA,IAAA;AACA,OANA;AAOA,KApBA;AAqBA,kBAAA,wBAAA;AACA,WAAA,KAAA,CAAA,GAAA,CAAA,qCAAA,EAAA;AACA,gBAAA;AAAA,cAAA;AAAA;AADA,OAAA,EAEA,IAFA,CAGA,UAAA,GAAA,EAAA;AACA;AACA,gBAAA,GAAA,CAAA,GAAA;AACA,aAAA,OAAA,GAAA,IAAA,IAAA;AACA,gBAAA,GAAA,CAAA,KAAA,QAAA;AAEA,OATA;AAUA,KAhCA;AAiCA,WAAA,iBAAA;AACA,WAAA,KAAA,CAAA,GAAA,CAAA,gCAAA,EAAA,EAAA,EACA,IADA,CAEA,UAAA,GAAA,EAAA;AACA,gBAAA,GAAA,CAAA,wBAAA;AACA,gBAAA,GAAA,CAAA,IAAA,IAAA,EAFA,CAGA;;AACA,aAAA,OAAA,GAAA,IAAA,IAAA;AACA,OAPA;AAQA,KA1CA;AA4CA,cA5CA,sBA4CA,GA5CA,EA4CA,OA5CA,EA4CA;AACA,cAAA,GAAA,CAAA,GAAA,EAAA,OAAA;AACA,KA9CA;AA+CA,eA/CA,uBA+CA,GA/CA,EA+CA,OA/CA,EA+CA;AACA,cAAA,GAAA,CAAA,GAAA,EAAA,OAAA;AACA,KAjDA;AAkDA,QAlDA,gBAkDA,IAlDA,EAkDA;AACA,WAAA,OAAA,CAAA,OAAA,CAAA,IAAA;AACA,KApDA;AAqDA,mBArDA,2BAqDA,IArDA,EAqDA;AACA;AACA,WAAA,OAAA,CAAA,KAAA,GAAA,KAAA,KAAA;AACA,WAAA,OAAA,CAAA,GAAA,GAAA,KAAA,GAAA,CAHA,CAIA;;AACA,WAAA,OAAA,CAAA,KAAA,GAAA,KAAA,KAAA;AACA,WAAA,OAAA,CAAA,GAAA,GAAA,KAAA,GAAA;AACA,cAAA,GAAA,CAAA,IAAA;AAEA,WAAA,KAAA,CAAA,GAAA,CAAA,qCAAA,EAAA;AACA,gBAAA;AAAA,cAAA,KAAA;AAAA;AADA,OAAA,EAEA,IAFA,CAGA,UAAA,GAAA,EAAA;AACA,gBAAA,GAAA,CAAA,YAAA;AACA,gBAAA,GAAA,CAAA,IAAA,IAAA;AACA,gBAAA,GAAA,CAAA,gBAAA;AACA,aAAA,OAAA,GAAA,IAAA,IAAA;AACA,gBAAA,GAAA,CAAA,KAAA,QAAA;AACA,OATA;AAWA,KAzEA;AA0EA,eA1EA,uBA0EA,IA1EA,EA0EA;AAAA;;AACA,UAAA,UAAA,KAAA,QAAA,CADA,CAEA;;AACA,WAAA,QAAA,CAAA,OAAA,EACA,IADA,CACA,aAAA;AACA,cAAA,KAAA,CAAA,IAAA,CACA,qCADA,EAEA,OAFA,EAGA,IAHA,CAIA,UAAA,GAAA,EAAA;AACA,kBAAA,GAAA,CAAA,GAAA;AACA,eAAA,MAAA,GAFA,CAEA;;AACA,mBAAA,MAAA;AACA,SARA;AASA,OAXA;AAeA,KA5FA;AA6FA,UA7FA,kBA6FA,MA7FA,EA6FA;AACA,cAAA,GAAA,CAAA,SAAA,OAAA;AACA,WAAA,QAAA,GAAA,MAAA;AAEA,KAjGA;AAkGA,SAlGA,iBAkGA,MAlGA,EAkGA;AACA,cAAA,GAAA,CAAA,SAAA,SAAA;AACA,WAAA,kBAAA,GAAA,IAAA;AACA,cAAA,GAAA,CAAA,MAAA;AACA,WAAA,OAAA,CAAA,EAAA,GAAA,OAAA,EAAA;AACA,WAAA,OAAA,CAAA,IAAA,GAAA,OAAA,IAAA;AACA,WAAA,OAAA,CAAA,KAAA,GAAA,OAAA,KAAA;AACA,WAAA,OAAA,CAAA,GAAA,GAAA,OAAA,GAAA;AACA,WAAA,OAAA,CAAA,GAAA,GAAA,OAAA,GAAA;AACA,WAAA,OAAA,CAAA,SAAA,GAAA,OAAA,SAAA;AACA,WAAA,OAAA,CAAA,MAAA,GAAA,OAAA,MAAA;AAIA,KAhHA;AAkHA;AACA,aAnHA,uBAmHA;AAAA;;AACA;AACA,WAAA,KAAA,CAAA,UAAA,CAAA,QAAA;AAAA;AAAA;AAAA;AAAA;AAAA,gCAAA,iBAAA,KAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AACA;;AADA,sBAEA,KAFA;AAAA;AAAA;AAAA;;AAAA,mDAEA,IAFA;;AAAA;AAAA;AAAA,yBAGA,OAAA,KAAA,CAAA,IAAA,CAAA,+BAAA,EAAA,OAAA,OAAA,CAHA;;AAAA;AAAA;AAGA,qBAHA,SAGA,IAHA;;AAIA;AAEA,yBAAA,KAAA,CAAA,UAAA,CAAA,WAAA,GANA,CAMA;AACA;;;AACA,2BAAA,MAAA;;AARA,wBASA,OAAA,IATA;AAAA;AAAA;AAAA;;AAAA,mDASA,OAAA,QAAA,CAAA,KAAA,CAAA,MAAA,CATA;;AAAA;AAUA,yBAAA,QAAA,CAAA,OAAA,CAAA,MAAA;;AACA,yBAAA,kBAAA,GAAA,KAAA,CAXA,CAWA;;AACA,yBAAA,WAAA,GAZA,CAYA;AACA;AACA;;;AAdA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SAAA;;AAAA;AAAA;AAAA;AAAA;AAgBA,KArIA;AAsIA;AACA,aAvIA,uBAuIA;AACA,cAAA,GAAA,CAAA,2BAAA;AACA,cAAA,GAAA,CAAA,KAAA,OAAA;AACA,cAAA,GAAA,CAAA,2BAAA;AACA,WAAA,KAAA,CAAA,IAAA,CAAA,+BAAA,EAAA,KAAA,OAAA,EAAA,IAAA,CACA,UAAA,GAAA,EAAA;AACA,aAAA,iBAAA,GAAA,KAAA,CADA,CAEA;;AACA,gBAAA,GAAA,CAAA,GAAA;AACA,iBAAA,MAAA;AAEA,OAPA;AAUA,KArJA;AAsJA,UAtJA,oBAsJA;AACA,WAAA,aAAA,GAAA,KAAA;AACA,WAAA,SAAA,CAAA,YAAA;AACA,aAAA,aAAA,GAAA,IAAA;AACA,OAFA;AAGA;AA3JA;AAjEA,CAAA","sourcesContent":["<template>\r\n    <el-row class=\"tac\">\r\n        <el-col :span=\"12\">\r\n            <el-button type=\"text\" @click=\"dialogmallVisible  = true\">添加节点</el-button>\r\n            <el-menu default-active=\"2\"\r\n                     class=\"el-menu-vertical-demo\"\r\n                     @open=\"handleOpen\"\r\n                     @close=\"handleClose\">\r\n                <el-submenu index=\"1\">\r\n                    <template slot=\"title\">\r\n\r\n                        <el-tree :data=\"data\"\r\n                                 :props=\"defaultProps\"\r\n                                 accordion\r\n                                 @node-click=\"handleNodeClick\">\r\n                        </el-tree>\r\n                    </template>\r\n                </el-submenu>\r\n\r\n            </el-menu>\r\n        </el-col>\r\n        <router-view v-if=\"isRouterAlive\"></router-view>\r\n\r\n        <template>\r\n\r\n            <el-button type=\"primary\" @click=\"dialogTableVisible  = true\">新增</el-button>\r\n            <el-button type=\"primary\" @click=\"deleteUsers(delUsers)\">删除</el-button>\r\n            <div id=\"users\">\r\n                <Users @return-value=\"getVal\" :title=\"tilevar\" @return-bj=\"getBj\" />\r\n            </div>\r\n            <!-- 添加用户弹框 -->\r\n            <el-dialog title=\"添加用户\"\r\n                       @close=\"addDialogClose\"\r\n                       :visible.sync=\"dialogTableVisible\"\r\n                       :close-on-click-modal=\"false\">\r\n                <!-- 添加用户的表单 -->\r\n                <el-form ref=\"addFormRef\" :rules=\"rulesAddUser\" :model=\"addUser\" label-width=\"100px\">\r\n                    <el-form-item prop=\"name\" label=\"姓名\">\r\n                        <el-input v-model=\"addUser.name\"></el-input>\r\n                    </el-form-item>\r\n                   \r\n                    <el-form-item prop=\"mid\" label=\"分组\">\r\n                        <el-input v-model=\"addUser.mname\" :disabled=\"true\"></el-input>\r\n                    </el-form-item>\r\n                    <el-form-item prop=\"sex\" label=\"性别\">\r\n                        <el-select v-model=\"addUser.sex\" clearable placeholder=\"请选择\">\r\n                            <el-option  label=\"男\"  value=\"男\"> </el-option>\r\n                            <el-option  label=\"女\"  value=\"女\"> </el-option>\r\n                        </el-select>\r\n                    </el-form-item>\r\n                    <el-form-item prop=\"tellphone\" label=\"手机号\">\r\n                        <el-input v-model=\"addUser.tellphone\"></el-input>\r\n                    </el-form-item>\r\n                    <el-form-item prop=\"deptid\" label=\"部门\">\r\n                        <el-select v-model=\"addUser.deptid\" clearable placeholder=\"请选择\">\r\n                            <el-option v-for=\"item in options\"\r\n                                       :key=\"item.deptid\"\r\n                                       :label=\"item.deptname\"\r\n                                       :value=\"item.deptid\">\r\n                            </el-option>\r\n                        </el-select>\r\n                    </el-form-item>\r\n                    <el-form-item>\r\n                        <el-button @click=\"dialogTableVisible = false\">取消</el-button>\r\n                        <el-button type=\"primary\" @click=\"onAddUser\">确定</el-button>\r\n                    </el-form-item>\r\n                </el-form>\r\n            </el-dialog>\r\n\r\n            <!-- 添加节点 -->\r\n            <el-dialog title=\"通讯录分组\"\r\n                       @close=\"addDialogClose\"\r\n                       :visible.sync=\"dialogmallVisible\"\r\n                       :close-on-click-modal=\"false\">\r\n                <!-- 添加通讯录分组的表单 -->\r\n                <el-form ref=\"addForm\" :model=\"addmall\" label-width=\"100px\">\r\n                    <el-form-item prop=\"fname\" label=\"父级节点\">\r\n                        <el-input v-model=\"addmall.fname\" :disabled=\"true\"></el-input>\r\n                    </el-form-item>\r\n                    <el-form-item prop=\"mname\" label=\"分组名称\">\r\n                        <el-input v-model=\"addmall.mname\"></el-input>\r\n                    </el-form-item>\r\n                    <el-form-item>\r\n                        <el-button @click=\"dialogmallVisible = false\">取消</el-button>\r\n                        <el-button type=\"primary\" @click=\"onaddmall\">确定</el-button>\r\n                    </el-form-item>\r\n                </el-form>\r\n            </el-dialog>\r\n\r\n\r\n        </template>\r\n\r\n    </el-row>\r\n\r\n</template>\r\n\r\n<script>\r\n    import Users from './list.vue';\r\n    import qs from 'qs'\r\n    //const delUsers=[];\r\n    export default {\r\n        name: 'users',\r\n        components: {\r\n            Users\r\n        },\r\n        data() {\r\n             // 自定义一个手机号验证规则\r\n                var checkMoblie = (rule, value, callback) => {\r\n                  if (!value.trim()) {\r\n                    return callback(new Error('请输入手机号'))\r\n                  }\r\n                  if (!/^1[34578]\\d{9}$/.test(value)) {\r\n                    return callback(new Error('手机号有误！请重填'))\r\n                  } else {\r\n                    callback()\r\n                  }\r\n                }\r\n            return {\r\n                isRouterAlive:true,\r\n                dialogTableVisible: false,// 添加用户弹框\r\n                 dialogmallVisible: false,\r\n                data: [],\r\n                delUsers: [],\r\n                tilevar: [],\r\n                options: [],\r\n                defaultProps: {\r\n                    children: 'popedomChildList',\r\n                    label: 'mname'\r\n                },\r\n                 // 添加用户\r\n                addUser: {\r\n                   id:'',\r\n                    name: '',\r\n                    mid: '',\r\n                    sex: '',\r\n                    tellphone: '',\r\n                    deptid:''\r\n                },\r\n                addmall: {\r\n                    pid: '',\r\n                   mname: ''\r\n                },\r\n                rulesAddUser: {\r\n                      name: [\r\n                               { required: true, message: '请输入用户名', trigger: 'blur' }\r\n                    ],\r\n                     sex: [\r\n                               { required: true, message: '请输入性别', trigger: 'blur' }\r\n                          ],\r\n                        tellphone: [\r\n                            { required: true, message: '请输入手机号', trigger: 'blur' },\r\n                            { validator: checkMoblie, trigger: 'blur' }\r\n                        ]\r\n\r\n                }\r\n\r\n            };\r\n            \r\n\r\n        },\r\n        mounted: function () { //钩子函数\r\n            this.get();\r\n            this.depts();\r\n            this.inituserlist();\r\n        },\r\n        methods: {\r\n            addDialogClose() {\r\n                this.addUser={\r\n                    id:'',\r\n                    name: '',\r\n                    mid: '',\r\n                    sex: '',\r\n                    tellphone: '',\r\n                    deptid:''\r\n                }\r\n                //  this.$refs.addFormRef.resetFields() //  不好使待检查\r\n                },\r\n            get: function () {\r\n                this.$http.get('http://localhost:8081/queryMaillist', {\r\n                }).then(\r\n                    function (res) {\r\n                        console.log(\"=================allllll\");\r\n                        console.log(res.data);\r\n                        this.data = res.data;\r\n                    })\r\n            },\r\n             inituserlist: function () {\r\n                this.$http.get('http://localhost:8081/userListBymid', {\r\n                    params: { id: 1 }\r\n                }).then(\r\n                    function (res) {\r\n                        //alert(title)\r\n                        console.log(res);\r\n                         this.tilevar = res.data;\r\n                        console.log(this.userList);\r\n\r\n                    })\r\n            },\r\n       depts: function () {\r\n                this.$http.get('http://localhost:8081/deptlist', {\r\n                }).then(\r\n                    function (res) {\r\n                        console.log(\"=================depts\");\r\n                        console.log(res.data);\r\n                       // this.data = res.data;\r\n                        this.options = res.data;\r\n                    })\r\n            },\r\n\r\n            handleOpen(key, keyPath) {\r\n                console.log(key, keyPath);\r\n            },\r\n            handleClose(key, keyPath) {\r\n                console.log(key, keyPath);\r\n            },\r\n            goTo(path) {\r\n                this.$router.replace(path);\r\n            },\r\n            handleNodeClick(data) {\r\n                //  添加通讯录赋值\r\n                this.addmall.fname = data.mname;\r\n                this.addmall.pid = data.mid;\r\n                //添加用户赋值\r\n                this.addUser.mname = data.mname;\r\n                this.addUser.mid = data.mid;\r\n                console.log(data)\r\n\r\n              this.$http.get('http://localhost:8081/userListBymid', {\r\n                  params:{id:data.mid}\r\n                }).then(\r\n                    function (res) {\r\n                        console.log(\"==========\");\r\n                        console.log(res.data);\r\n                        console.log(\"==============\");\r\n                        this.tilevar = res.data;\r\n                        console.log(this.userList);\r\n                    })\r\n\r\n            }\r\n            , deleteUsers(data) {\r\n                let userDto = this.delUsers;\r\n                //  执行删除的方法\r\n                  this.$confirm('确认删除？')\n                      .then(_ => {\r\n                                 this.$http.post(\r\n                            'http://localhost:8081/deleUserBatch',\r\n                            userDto\r\n                         ).then(\r\n                            function (res) {\r\n                                console.log(res);\r\n                                this.reload();//刷新页面\r\n                                location.reload();\r\n                            })   \r\n                      })\r\n               \r\n\r\n\r\n            },\r\n            getVal(result) {\r\n                console.log(result + \"=====\");\r\n                this.delUsers = result;\r\n\r\n            },\r\n            getBj(result) {\r\n                console.log(result + \"==bj===\");\r\n                this.dialogTableVisible = true;\r\n                console.log(result);\r\n                this.addUser.id = result.id;\r\n                this.addUser.name = result.name;\r\n                this.addUser.mname = result.mname;\r\n                this.addUser.mid= result.mid\r\n                this.addUser.sex = result.sex;\r\n                this.addUser.tellphone = result.tellphone;\r\n                this.addUser.deptid = result.deptid;\r\n\r\n               \r\n\r\n            },\r\n\r\n             // 点击添加用户\r\n            onAddUser() {\r\n                 //this.$refs.addFormRef.resetFields() // 清空表单\r\n                this.$refs.addFormRef.validate(async valid => {\r\n                    debugger;\r\n                    if (!valid) return null  // 如果验证失败就不往下继续执行\r\n                    const { data: res } = await this.$http.post('http://localhost:8081/addUser', this.addUser)\r\n                   // this.addUser.name = '';\r\n                   \r\n                     this.$refs.addFormRef.resetFields() // 清空表单\r\n                      //刷新页面\r\n                       location.reload();\r\n                    if (res!=true) return this.$message.error(\"添加失败\")\r\n                    this.$message.success('添加成功')\r\n                    this.dialogTableVisible = false  // 关闭弹框\r\n                      this.getUserList() // 重新调用，刷新表单\r\n                    //  this.reload();//刷新页面\r\n                      // location.reload();\r\n                  })\r\n            },\r\n              // 添加通讯录\r\n            onaddmall() {\r\n                 console.log(\"-------------------------\");\r\n                console.log(this.addmall);\r\n              console.log(\"-------------------------\");\r\n                 this.$http.post('http://localhost:8081/addmail',this.addmall).then(\r\n                     function (res) {\r\n                         this.dialogmallVisible = false;\r\n                        //alert(title)\r\n                        console.log(res);\r\n                       location.reload();\r\n\r\n                    })\r\n\r\n\r\n            },\r\n            reload() {\r\n                this.isRouterAlive = false\r\n                this.$nextTick(function () {\r\n                     this.isRouterAlive = true\r\n                })\r\n            }\r\n\r\n        }\r\n    };\r\n</script>\r\n\r\n<style scoped>\r\n    .el-col-12 {\r\n        width: 25%;\r\n    }\r\n</style>"],"sourceRoot":"src/views"}]}